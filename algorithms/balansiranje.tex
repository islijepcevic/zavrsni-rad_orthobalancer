\begin{algorithm}[h!]

\centering
\caption{Obilazak stabla --- balansiranje vrsta}
\label{algo:balance}

\begin{algorithmic}[1]

%TODO - pozvano s cvorom 'root'
\State $ULAZ:$ taksonomsko stablo, skup zamjenjivih čvorova, $n$ skupova vrsta
\State $SREDIŠNJE STRUKTURE PODATAKA:$ %TODO (sve postavljeno - opisati)
\State $IZLAZ:$ višeslojni rječnik $out$koji za svaki balansirani čvor sadrži
listu vrsta predstavnica iz svake grupe $g$  

\Function{balansiraj}{cvor, grupe}
    \State $izlaz \gets$ new $izlaz$
    \ForAll{$dijete \in cvor.djeca$}
        \State $izlaz \gets izlaz \cup balansiraj(dijete, grupe)$
        \If{$\neg dijete.balansiran$}
            \ForAll{$g \in grupe$}
                \State $cvor.brojac[g] \gets cvor.brojac[g] + dijete.brojac[g]$
            \EndFor
        \EndIf
    \EndFor
    \If{$cvor.brojac[g] > 0 \forall g \in grupe$}
        \State $cvor.balansiran \gets \top$
        \If{$\exists k \forall g \in grupe | cvor.brojac[g] = k$}
        %\If{$\forall g \in grupe cvor.brojac[g] SU JEDNAKI$}
            \State $A \gets$ skup svih pripadajućih vrsta pod cvorom $cvor$
            \State $izlaz.pridruzi(A)$
        \Else
            \State $n \gets \min\{brojac[g] \in cvor\}$
            \State $R \gets \forall g \in grupe$ odaberi $n$ slučajnih vrsta pod
cvorom $cvor$
            \State $izlaz.pridruzi(R)$
        \EndIf
    \EndIf
    \Return $izlaz$
\EndFunction

\algstore{balans}
\end{algorithmic}
\end{algorithm}

\begin{algorithm}[h!]
\begin{algorithmic}[1]
\algrestore{balans}

\Function{obidiStablo}{$cvor, grupe$}
    \If{$čvor.zamjenski()$}
    \Comment{metoda vraća istinu ako je čvor u zamjenskom podstablu} \\
%        \State $izlaz \gets$ new $izlaz$
        \Return $balansiraj(cvor, grupe)$
    \Else
        \If{$cvor.list()$}
        \Comment{metoda vraća istinu ako je čvor list}
            \ForAll{$grupa \in grupe$}
                \State $izlaz[grupa]['nezamjenski'] \gets cvor.ime$
            \EndFor
        \Else
            \State $izlaz \gets$ new $izlaz$
            \ForAll{$dijete \in cvor.dijeca$}
                \If{$dijete.ukupniBrojac = čvor.ukupniBrojac$}
                    \State $izlaz \in izlaz \cup obidiStablo(dijete, grupe)$
                \EndIf
            \EndFor
        \EndIf
    \EndIf
    \Return $izlaz$
\EndFunction

\end{algorithmic}
\end{algorithm}  
